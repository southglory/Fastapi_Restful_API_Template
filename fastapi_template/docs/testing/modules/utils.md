# 유틸리티 모듈 테스트 가이드

[@utils](/fastapi_template/app/common/utils)

## 개요

`utils` 모듈은 애플리케이션 전반에서 사용되는 다양한 유틸리티 함수들로 구성되어 있습니다. 이러한 함수들은 작고 독립적이지만 여러 곳에서 사용되므로 철저한 테스트가 필요합니다.

## 테스트 용이성

- **난이도**: 쉬움
- **이유**:
  - 대부분 순수 함수로 구현됨
  - 입력과 출력이 명확하게 정의됨
  - 외부 의존성이 적음
  - 상태를 유지하지 않음

## 테스트 대상

주요 테스트 대상은 다음과 같습니다:

1. **날짜/시간 유틸리티**
   - 날짜 포맷팅
   - 현재 시간 획득
   - 시간 연산

2. **ORM 유틸리티**
   - SQLAlchemy 컬럼 값 추출
   - Python 타입 변환
   - 기본값 처리

3. **페이지네이션 유틸리티**
   - 페이지네이션 파라미터 처리
   - 페이지네이션 결과 생성
   - 엣지 케이스 처리

## 테스트 접근법

Utils 모듈을 테스트할 때 다음 접근법을 권장합니다:

1. **기본 기능 테스트**: 표준 입력값에 대한 기본 함수 동작 검증
2. **경계값 분석**: 최소/최대값, 빈 컬렉션, None 등 경계 케이스 테스트
3. **파라미터화된 테스트**: 여러 입력 조합에 대한 효율적인 테스트

## 구현된 테스트 코드

각 유틸리티 유형별 테스트 코드:

### 날짜/시간 유틸리티 테스트

- [날짜/시간 유틸리티 테스트 코드](/fastapi_template/tests/test_utils/test_datetime.py)

### ORM 유틸리티 테스트

- [ORM 유틸리티 테스트 코드](/fastapi_template/tests/test_utils/test_orm_utils.py)

### 페이지네이션 유틸리티 테스트

- [페이지네이션 유틸리티 테스트 코드](/fastapi_template/tests/test_utils/test_pagination.py)

## 테스트 커버리지 확인

Utils 모듈은 100% 테스트 커버리지를 달성했습니다:

```bash
pytest --cov=app.common.utils tests/test_utils/ -v
```

## 모범 사례

1. 모든 유틸리티 함수에 대해 표준 케이스와 예외 케이스를 테스트합니다.
2. 페이지네이션의 경우 첫 페이지, 중간 페이지, 마지막 페이지, 빈 페이지 등 다양한 시나리오를 테스트합니다.
3. ORM 함수는 실제 SQLAlchemy 모델과 유사한 객체를 사용하여 현실적인 테스트를 수행합니다.
4. 의존성이 있는 함수(예: 현재 시간)는 모킹을 사용하여 일관된 결과를 보장합니다.

## 주의사항

1. 날짜/시간 함수는 타임존과 로케일에 민감할 수 있으므로 명시적으로 지정해야 합니다.
2. 페이지네이션 테스트에서는 빈 컬렉션과 총 항목 수가 0인 경우를 별도로 테스트해야 합니다.
3. ORM 유틸리티는 다양한 타입의 컬럼(Integer, String, DateTime 등)에 대해 테스트해야 합니다.
4. 모든 함수는 None 값과 기본값 처리를 테스트하여 견고성을 보장해야 합니다.
